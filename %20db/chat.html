<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZeroID.IA - Chat Neural</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600&family=Poppins:wght@300;400;500;600&family=JetBrains+Mono:wght@300;400&display=swap" rel="stylesheet">
    <style>
        /* Reset e variáveis CSS */
        :root {
            --black: #000000;
            --white: #ffffff;
            --gray-100: #f5f5f5;
            --gray-200: #e0e0e0;
            --gray-300: #c0c0c0;
            --gray-400: #9e9e9e;
            --gray-500: #757575;
            --gray-600: #616161;
            --gray-700: #424242;
            --gray-800: #212121;
            --gray-900: #111111;
            --neon-glow: 0 0 10px rgba(255, 255, 255, 0.8),
                         0 0 20px rgba(255, 255, 255, 0.6),
                         0 0 30px rgba(255, 255, 255, 0.4);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background-color: var(--black);
            color: var(--white);
            font-family: 'Inter', 'Poppins', sans-serif;
            height: 100vh;
            overflow: hidden;
        }
        
        /* Fontes */
        h1, h2, h3, h4, h5, h6 {
            font-family: 'Space Grotesk', sans-serif;
            font-weight: 600;
        }
        
        .code-font {
            font-family: 'JetBrains Mono', monospace;
        }
        
        /* Animações */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes slideInLeft {
            from { opacity: 0; transform: translateX(-50px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        @keyframes glowPulse {
            0%, 100% { box-shadow: var(--neon-glow); }
            50% { box-shadow: 0 0 20px rgba(255, 255, 255, 0.6); }
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 0.4; }
            50% { opacity: 1; }
        }
        
        @keyframes typingDots {
            0%, 20% { content: '.'; }
            40% { content: '..'; }
            60%, 100% { content: '...'; }
        }
        
        /* Layout do chat */
        .chat-container {
            display: flex;
            height: 100vh;
            animation: fadeIn 0.5s ease;
        }
        
        /* Sidebar */
        .chat-sidebar {
            width: 300px;
            background: var(--gray-900);
            border-right: 1px solid var(--gray-700);
            display: flex;
            flex-direction: column;
            padding: 20px;
        }
        
        .sidebar-header {
            margin-bottom: 30px;
        }
        
        .sidebar-logo {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 20px;
            text-align: center;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--gray-700);
        }
        
        .btn-new-chat {
            width: 100%;
            padding: 14px;
            background: var(--gray-800);
            color: var(--white);
            border: 1px solid var(--gray-600);
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .btn-new-chat:hover {
            border-color: var(--white);
            background: var(--gray-700);
            transform: translateY(-2px);
        }
        
        /* Lista de conversas */
        .conversations-list {
            flex: 1;
            overflow-y: auto;
            margin: 20px 0;
            padding-right: 10px;
        }
        
        .conversation-item {
            padding: 15px;
            margin-bottom: 10px;
            background: var(--gray-800);
            border: 1px solid transparent;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            animation: slideInLeft 0.3s ease;
        }
        
        .conversation-item:hover {
            border-color: var(--gray-600);
            transform: translateX(5px);
        }
        
        .conversation-item.active {
            border-color: var(--white);
            background: var(--gray-700);
            animation: glowPulse 2s infinite;
        }
        
        .conversation-title {
            font-weight: 600;
            margin-bottom: 5px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            font-size: 1rem;
        }
        
        .conversation-preview {
            color: var(--gray-400);
            font-size: 0.9rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .conversation-time {
            color: var(--gray-500);
            font-size: 0.8rem;
            margin-top: 8px;
            text-align: right;
        }
        
        /* Footer da sidebar */
        .sidebar-footer {
            padding-top: 20px;
            border-top: 1px solid var(--gray-700);
        }
        
        .btn-settings {
            width: 100%;
            padding: 14px;
            background: transparent;
            color: var(--white);
            border: 1px solid var(--gray-600);
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .btn-settings:hover {
            border-color: var(--white);
            transform: translateY(-2px);
        }
        
        /* Área principal do chat */
        .chat-main {
            flex: 1;
            display: flex;
            flex-direction: column;
            padding: 0 20px;
            background: var(--black);
        }
        
        .chat-header {
            padding: 25px 0;
            border-bottom: 1px solid var(--gray-700);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .chat-title {
            font-size: 1.8rem;
            font-weight: 600;
        }
        
        .btn-vibezz {
            padding: 12px 24px;
            background: transparent;
            color: var(--white);
            border: 1px solid var(--gray-600);
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .btn-vibezz:hover {
            border-color: var(--white);
            transform: translateY(-2px);
        }
        
        /* Área de mensagens */
        .messages-container {
            flex: 1;
            overflow-y: auto;
            padding: 30px 0;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .message {
            max-width: 70%;
            padding: 20px;
            border-radius: 12px;
            animation: slideUp 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .message::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.05), transparent);
            z-index: 1;
        }
        
        .message.user {
            align-self: flex-end;
            background: var(--gray-800);
            border: 1px solid var(--gray-700);
        }
        
        .message.ai {
            align-self: flex-start;
            background: transparent;
            border: 1px solid var(--gray-700);
        }
        
        .message-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            font-size: 0.9rem;
            position: relative;
            z-index: 2;
        }
        
        .message-sender {
            font-weight: 600;
            color: var(--white);
        }
        
        .message-time {
            color: var(--gray-400);
            font-size: 0.85rem;
        }
        
        .message-content {
            line-height: 1.6;
            position: relative;
            z-index: 2;
        }
        
        /* Processo de pensamento */
        .thinking-process {
            background: var(--gray-900);
            border: 1px solid var(--gray-700);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            animation: slideUp 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .thinking-process::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.03), transparent);
            animation: slideLeft 2s infinite linear;
        }
        
        @keyframes slideLeft {
            from { transform: translateX(-100%); }
            to { transform: translateX(100%); }
        }
        
        .thinking-title {
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--gray-300);
            position: relative;
            z-index: 2;
        }
        
        .thinking-steps {
            display: flex;
            flex-direction: column;
            gap: 12px;
            position: relative;
            z-index: 2;
        }
        
        .thinking-step {
            display: flex;
            align-items: center;
            gap: 12px;
            color: var(--gray-400);
        }
        
        .step-dots {
            display: flex;
            gap: 4px;
        }
        
        .dot {
            width: 8px;
            height: 8px;
            background: var(--gray-500);
            border-radius: 50%;
            animation: pulse 1.5s infinite;
        }
        
        .dot:nth-child(2) {
            animation-delay: 0.2s;
        }
        
        .dot:nth-child(3) {
            animation-delay: 0.4s;
        }
        
        /* Input de mensagem */
        .input-container {
            padding: 25px 0;
            border-top: 1px solid var(--gray-700);
        }
        
        .input-wrapper {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        #message-input {
            flex: 1;
            min-height: 60px;
            max-height: 200px;
            padding: 18px;
            background: var(--gray-900);
            border: 1px solid var(--gray-700);
            border-radius: 12px;
            color: var(--white);
            font-family: 'Inter', sans-serif;
            font-size: 1rem;
            resize: none;
            outline: none;
            transition: all 0.3s ease;
        }
        
        #message-input:focus {
            border-color: var(--white);
            box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.1);
        }
        
        .input-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .char-counter {
            color: var(--gray-400);
            font-size: 0.9rem;
        }
        
        .btn-send {
            padding: 14px 35px;
            background: var(--white);
            color: var(--black);
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
        }
        
        .btn-send:hover {
            background: var(--gray-200);
            transform: translateY(-2px);
        }
        
        .btn-send:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        /* Mensagem de boas-vindas */
        .welcome-message {
            text-align: center;
            color: var(--gray-400);
            font-style: italic;
            padding: 60px 40px;
            font-size: 1.1rem;
            animation: fadeIn 1s ease;
        }
        
        /* Modal de configurações */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.3s ease;
        }
        
        .modal-content {
            background: var(--gray-900);
            border-radius: 16px;
            padding: 40px;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            border: 1px solid var(--gray-700);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }
        
        .modal-title {
            font-size: 1.8rem;
        }
        
        .modal-close {
            background: none;
            border: none;
            color: var(--white);
            font-size: 2rem;
            cursor: pointer;
            padding: 5px;
            transition: transform 0.3s ease;
        }
        
        .modal-close:hover {
            transform: rotate(90deg);
        }
        
        .settings-options {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }
        
        .settings-option {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .settings-option label {
            font-weight: 600;
            color: var(--gray-300);
        }
        
        .settings-option select {
            padding: 12px;
            background: var(--gray-800);
            color: var(--white);
            border: 1px solid var(--gray-700);
            border-radius: 8px;
            outline: none;
            font-family: 'Inter', sans-serif;
            font-size: 1rem;
            cursor: pointer;
        }
        
        .settings-option select:focus {
            border-color: var(--white);
        }
        
        .settings-buttons {
            display: flex;
            justify-content: flex-end;
            margin-top: 30px;
        }
        
        /* Scrollbar customizada */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: var(--gray-900);
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--gray-600);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--gray-500);
        }
        
        /* Responsividade */
        @media (max-width: 1024px) {
            .chat-sidebar {
                width: 250px;
            }
        }
        
        @media (max-width: 768px) {
            .chat-container {
                flex-direction: column;
            }
            
            .chat-sidebar {
                width: 100%;
                height: 250px;
                border-right: none;
                border-bottom: 1px solid var(--gray-700);
            }
            
            .conversations-list {
                max-height: 150px;
            }
            
            .chat-main {
                height: calc(100vh - 250px);
            }
            
            .message {
                max-width: 85%;
            }
        }
        
        @media (max-width: 480px) {
            .chat-sidebar {
                padding: 15px;
            }
            
            .chat-main {
                padding: 0 15px;
            }
            
            .message {
                max-width: 90%;
                padding: 15px;
            }
            
            .btn-send {
                padding: 12px 25px;
            }
        }
    </style>
</head>
<body class="chat-page">
    <div class="chat-container">
        <!-- Sidebar -->
        <div class="chat-sidebar">
            <div class="sidebar-header">
                <div class="sidebar-logo">ZeroID.IA</div>
                <button id="new-chat-btn" class="btn-new-chat">
                    <i class="fas fa-plus"></i> Nova Conversa
                </button>
            </div>
            
            <div class="conversations-list" id="conversations-list">
                <!-- Conversas serão carregadas aqui -->
            </div>
            
            <div class="sidebar-footer">
                <button id="settings-btn" class="btn-settings">
                    <i class="fas fa-cog"></i> Configurações
                </button>
            </div>
        </div>
        
        <!-- Área principal -->
        <div class="chat-main">
            <div class="chat-header">
                <h2 id="current-conversation-title">Nova Conversa</h2>
                <button onclick="navigateTo('pagvibe1.html')" class="btn-vibezz">
                    <i class="fas fa-share-nodes"></i> Vibezz
                </button>
            </div>
            
            <div class="messages-container" id="messages-container">
                <!-- Mensagens serão exibidas aqui -->
                <div class="welcome-message">
                    <p>Bem-vindo ao Chat Neural da ZeroID.IA. Comece uma nova conversa ou selecione uma conversa anterior.</p>
                </div>
            </div>
            
            <div class="input-container">
                <div class="input-wrapper">
                    <textarea id="message-input" 
                              placeholder="Digite sua mensagem aqui... (Suporte a Markdown: **negrito**, *itálico*, `código`)"
                              rows="3"></textarea>
                </div>
                <div class="input-footer">
                    <div class="char-counter">
                        <span id="char-count">0</span>/5000
                    </div>
                    <button id="send-btn" class="btn-send">
                        <i class="fas fa-paper-plane"></i> Enviar
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal de configurações -->
    <div id="settings-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Configurações do Chat</h3>
                <button class="modal-close">&times;</button>
            </div>
            
            <div class="settings-options">
                <div class="settings-option">
                    <label for="ai-model">Modelo de IA:</label>
                    <select id="ai-model">
                        <option value="gpt">GPT-4 (Padrão)</option>
                        <option value="claude">Claude 3</option>
                        <option value="gemini">Gemini Pro</option>
                    </select>
                </div>
                
                <div class="settings-option">
                    <label for="thinking-process">Mostrar processo de pensamento:</label>
                    <select id="thinking-process">
                        <option value="yes">Sim</option>
                        <option value="no">Não</option>
                    </select>
                </div>
                
                <div class="settings-option">
                    <button id="export-btn" class="btn-new-chat">
                        <i class="fas fa-download"></i> Exportar conversas (JSON)
                    </button>
                </div>
                
                <div class="settings-buttons">
                    <button id="close-settings" class="btn-new-chat">Fechar</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Classe ChatManager
        class ChatManager {
            constructor() {
                this.currentConversationId = null;
                this.conversations = [];
                this.showThinkingProcess = true;
                this.currentUser = null;
                this.isLoading = false;
                
                this.init();
            }
            
            async init() {
                // Verificar autenticação
                if (!this.checkAuth()) {
                    this.navigateTo('index.html');
                    return;
                }
                
                this.currentUser = this.getCurrentUser();
                this.setupEventListeners();
                await this.loadConversations();
                
                if (this.conversations.length === 0) {
                    this.createNewConversation();
                } else {
                    this.selectConversation(this.conversations[0].id);
                }
            }
            
            setupEventListeners() {
                // Novo chat
                document.getElementById('new-chat-btn')?.addEventListener('click', () => {
                    this.createNewConversation();
                });
                
                // Enviar mensagem
                document.getElementById('send-btn')?.addEventListener('click', () => {
                    this.sendMessage();
                });
                
                // Enter para enviar (Shift+Enter para nova linha)
                document.getElementById('message-input')?.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        this.sendMessage();
                    }
                });
                
                // Contador de caracteres
                document.getElementById('message-input')?.addEventListener('input', (e) => {
                    const count = e.target.value.length;
                    document.getElementById('char-count').textContent = count;
                    
                    // Auto-expandir textarea
                    e.target.style.height = 'auto';
                    e.target.style.height = e.target.scrollHeight + 'px';
                    
                    // Habilitar/desabilitar botão enviar
                    const sendBtn = document.getElementById('send-btn');
                    sendBtn.disabled = count === 0 || count > 5000;
                });
                
                // Configurações
                document.getElementById('settings-btn')?.addEventListener('click', () => {
                    this.openSettings();
                });
                
                document.getElementById('close-settings')?.addEventListener('click', () => {
                    this.closeSettings();
                });
                
                document.getElementById('close-settings')?.addEventListener('click', () => {
                    this.closeSettings();
                });
                
                document.getElementById('export-btn')?.addEventListener('click', () => {
                    this.exportConversations();
                });
                
                // Processo de pensamento
                document.getElementById('thinking-process')?.addEventListener('change', (e) => {
                    this.showThinkingProcess = e.target.value === 'yes';
                });
                
                // Fechar modal com ESC
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape') {
                        this.closeSettings();
                    }
                });
            }
            
            async loadConversations() {
                try {
                    // Carregar do LocalStorage
                    const stored = localStorage.getItem('zeroid_conversations');
                    this.conversations = stored ? JSON.parse(stored) : [];
                    
                    // Filtrar conversas do usuário atual
                    if (this.currentUser) {
                        this.conversations = this.conversations.filter(
                            conv => conv.userId === this.currentUser.id
                        );
                    }
                    
                    this.renderConversations();
                } catch (error) {
                    console.error('Erro ao carregar conversas:', error);
                    this.conversations = [];
                }
            }
            
            renderConversations() {
                const container = document.getElementById('conversations-list');
                if (!container) return;
                
                container.innerHTML = '';
                
                if (this.conversations.length === 0) {
                    container.innerHTML = `
                        <div style="text-align: center; color: var(--gray-500); padding: 20px;">
                            Nenhuma conversa encontrada
                        </div>
                    `;
                    return;
                }
                
                // Ordenar por data (mais recente primeiro)
                this.conversations.sort((a, b) => new Date(b.updatedAt) - new Date(a.updatedAt));
                
                this.conversations.forEach(conversation => {
                    const item = document.createElement('div');
                    item.className = `conversation-item ${
                        this.currentConversationId === conversation.id ? 'active' : ''
                    }`;
                    item.dataset.id = conversation.id;
                    
                    const lastMessage = conversation.messages?.[conversation.messages.length - 1];
                    const preview = lastMessage?.content?.substring(0, 40) || 'Nenhuma mensagem';
                    const time = conversation.updatedAt ? 
                        new Date(conversation.updatedAt).toLocaleTimeString([], {
                            hour: '2-digit',
                            minute: '2-digit'
                        }) : 'Agora';
                    
                    item.innerHTML = `
                        <div class="conversation-title">${conversation.title}</div>
                        <div class="conversation-preview">${preview}${preview.length >= 40 ? '...' : ''}</div>
                        <div class="conversation-time">${time}</div>
                    `;
                    
                    item.addEventListener('click', () => {
                        this.selectConversation(conversation.id);
                    });
                    
                    container.appendChild(item);
                });
            }
            
            createNewConversation() {
                const conversation = {
                    id: Date.now().toString(),
                    userId: this.currentUser?.id,
                    title: `Conversa ${this.conversations.length + 1}`,
                    messages: [],
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                };
                
                this.conversations.unshift(conversation);
                this.saveConversations();
                this.renderConversations();
                this.selectConversation(conversation.id);
                
                // Focus no input
                document.getElementById('message-input').focus();
            }
            
            selectConversation(id) {
                this.currentConversationId = id;
                const conversation = this.conversations.find(conv => conv.id === id);
                
                if (!conversation) {
                    this.createNewConversation();
                    return;
                }
                
                // Atualizar título
                document.getElementById('current-conversation-title').textContent = conversation.title;
                
                // Renderizar mensagens
                this.renderMessages(conversation.messages);
                
                // Atualizar lista de conversas
                this.renderConversations();
                
                // Scroll para baixo
                this.scrollToBottom();
            }
            
            renderMessages(messages) {
                const container = document.getElementById('messages-container');
                if (!container) return;
                
                container.innerHTML = '';
                
                if (!messages || messages.length === 0) {
                    container.innerHTML = `
                        <div class="welcome-message">
                            <p>Bem-vindo ao Chat Neural da ZeroID.IA. Comece uma nova conversa ou selecione uma conversa anterior.</p>
                        </div>
                    `;
                    return;
                }
                
                messages.forEach(message => {
                    this.addMessageToUI(message, false);
                });
            }
            
            async sendMessage() {
                if (this.isLoading) return;
                
                const input = document.getElementById('message-input');
                const message = input.value.trim();
                
                if (!message) return;
                
                // Verificar limite de caracteres
                if (message.length > 5000) {
                    alert('A mensagem excede o limite de 5000 caracteres.');
                    return;
                }
                
                // Adicionar mensagem do usuário
                const userMessage = {
                    id: Date.now().toString(),
                    sender: 'user',
                    content: message,
                    timestamp: new Date().toISOString()
                };
                
                this.addMessageToUI(userMessage, true);
                this.saveMessage(userMessage);
                
                // Limpar input
                input.value = '';
                input.style.height = 'auto';
                document.getElementById('char-count').textContent = '0';
                document.getElementById('send-btn').disabled = true;
                
                // Simular resposta da IA
                this.isLoading = true;
                document.getElementById('send-btn').disabled = true;
                
                await this.simulateAIResponse(message);
                
                this.isLoading = false;
                document.getElementById('send-btn').disabled = false;
            }
            
            async simulateAIResponse(userMessage) {
                if (this.showThinkingProcess) {
                    this.showThinkingAnimation();
                    
                    // Aguardar para simular processamento
                    await new Promise(resolve => setTimeout(resolve, 2000 + Math.random() * 2000));
                    
                    // Remover animação de pensamento
                    const thinkingElement = document.querySelector('.thinking-process');
                    if (thinkingElement) {
                        thinkingElement.remove();
                    }
                }
                
                // Gerar resposta simulada
                const response = await this.generateAIResponse(userMessage);
                
                // Adicionar resposta da IA
                const aiMessage = {
                    id: Date.now().toString(),
                    sender: 'ai',
                    content: response,
                    timestamp: new Date().toISOString()
                };
                
                this.addMessageToUI(aiMessage, true);
                this.saveMessage(aiMessage);
            }
            
            async generateAIResponse(userMessage) {
                // Respostas simuladas baseadas no conteúdo
                const responses = [
                    'Olá! Eu sou a ZeroID.IA, sua assistente de consciência neural simulada. Como posso ajudá-lo hoje?',
                    'Entendi sua consulta. Como uma IA neural avançada, posso ajudá-lo com análise de texto, geração de conteúdo, respostas a perguntas complexas e muito mais.',
                    'Baseado em sua pergunta, posso fornecer informações detalhadas sobre diversos tópicos. Há algo específico em que posso ser útil?',
                    'Sua mensagem foi processada pela nossa rede neural. Posso oferecer insights, análises ou assistência em qualquer assunto que você precisar.',
                    'A ZeroID.IA utiliza processamento neural avançado para entender e responder a consultas complexas. Como posso ajudar você hoje?'
                ];
                
                // Respostas para palavras-chave específicas
                const keywordResponses = {
                    'olá|oi|hello|hi': 'Olá! É um prazer conversar com você. Como posso ajudá-lo hoje?',
                    'como você funciona|como funciona': 'Eu utilizo uma arquitetura de rede neural avançada que simula processos cognitivos humanos. Minha base de conhecimento integra múltiplos modelos de IA para fornecer respostas contextuais e adaptativas.',
                    'vibezz|rede social': 'Vibezz é nossa rede social neural em desenvolvimento. É um espaço onde mentes se conectam através de interações neurais avançadas. Em breve você poderá experimentar!',
                    'segurança|privacidade': 'Sua segurança é nossa prioridade. Todas as conversas são criptografadas end-to-end e seus dados nunca são compartilhados com terceiros.',
                    'obrigado|thanks|grato': 'De nada! Estou aqui para ajudar. Se tiver mais alguma dúvida, é só perguntar.'
                };
                
                // Procurar resposta correspondente por palavra-chave
                const lowerMessage = userMessage.toLowerCase();
                for (const [pattern, response] of Object.entries(keywordResponses)) {
                    if (new RegExp(pattern).test(lowerMessage)) {
                        return response;
                    }
                }
                
                // Resposta aleatória padrão
                return responses[Math.floor(Math.random() * responses.length)];
            }
            
            showThinkingAnimation() {
                const container = document.getElementById('messages-container');
                
                const thinkingElement = document.createElement('div');
                thinkingElement.className = 'thinking-process';
                thinkingElement.innerHTML = `
                    <div class="thinking-title">Processando sua mensagem...</div>
                    <div class="thinking-steps">
                        <div class="thinking-step">
                            <div class="step-dots">
                                <div class="dot"></div>
                                <div class="dot"></div>
                                <div class="dot"></div>
                            </div>
                            <span>Analisando contexto...</span>
                        </div>
                        <div class="thinking-step">
                            <div class="step-dots">
                                <div class="dot"></div>
                                <div class="dot"></div>
                                <div class="dot"></div>
                            </div>
                            <span>Consultando base de conhecimento...</span>
                        </div>
                        <div class="thinking-step">
                            <div class="step-dots">
                                <div class="dot"></div>
                                <div class="dot"></div>
                                <div class="dot"></div>
                            </div>
                            <span>Sintetizando resposta...</span>
                        </div>
                    </div>
                `;
                
                container.appendChild(thinkingElement);
                this.scrollToBottom();
            }
            
            addMessageToUI(message, scroll = true) {
                const container = document.getElementById('messages-container');
                
                // Remover mensagem de boas-vindas se existir
                const welcomeMessage = container.querySelector('.welcome-message');
                if (welcomeMessage) {
                    welcomeMessage.remove();
                }
                
                const messageElement = document.createElement('div');
                messageElement.className = `message ${message.sender}`;
                
                const time = new Date(message.timestamp).toLocaleTimeString([], {
                    hour: '2-digit',
                    minute: '2-digit'
                });
                
                messageElement.innerHTML = `
                    <div class="message-header">
                        <span class="message-sender">${
                            message.sender === 'user' ? 'Você' : 'ZeroID.IA'
                        }</span>
                        <span class="message-time">${time}</span>
                    </div>
                    <div class="message-content">${this.formatMessage(message.content)}</div>
                `;
                
                container.appendChild(messageElement);
                
                if (scroll) {
                    this.scrollToBottom();
                }
            }
            
            formatMessage(content) {
                // Converter Markdown simples para HTML
                let formatted = content
                    .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                    .replace(/\*(.*?)\*/g, '<em>$1</em>')
                    .replace(/`(.*?)`/g, '<code class="code-font">$1</code>')
                    .replace(/\n/g, '<br>');
                
                return formatted;
            }
            
            saveMessage(message) {
                if (!this.currentConversationId) return;
                
                const conversation = this.conversations.find(conv => conv.id === this.currentConversationId);
                if (!conversation) return;
                
                // Adicionar mensagem à conversa
                if (!conversation.messages) {
                    conversation.messages = [];
                }
                conversation.messages.push(message);
                
                // Atualizar título se for a primeira mensagem
                if (conversation.messages.length === 1) {
                    conversation.title = message.content.substring(0, 30) + 
                        (message.content.length > 30 ? '...' : '');
                }
                
                // Atualizar timestamp
                conversation.updatedAt = new Date().toISOString();
                
                // Salvar no LocalStorage
                this.saveConversations();
                
                // Atualizar lista de conversas
                this.renderConversations();
            }
            
            saveConversations() {
                // Salvar todas as conversas no LocalStorage
                localStorage.setItem('zeroid_conversations', JSON.stringify(this.conversations));
            }
            
            scrollToBottom() {
                const container = document.getElementById('messages-container');
                setTimeout(() => {
                    container.scrollTop = container.scrollHeight;
                }, 100);
            }
            
            openSettings() {
                document.getElementById('settings-modal').style.display = 'flex';
            }
            
            closeSettings() {
                document.getElementById('settings-modal').style.display = 'none';
            }
            
            exportConversations() {
                const data = {
                    user: this.currentUser,
                    conversations: this.conversations,
                    exportDate: new Date().toISOString()
                };
                
                const blob = new Blob([JSON.stringify(data, null, 2)], {
                    type: 'application/json'
                });
                
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `zeroid-conversations-${new Date().toISOString().split('T')[0]}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                alert('Conversas exportadas com sucesso! O arquivo será baixado automaticamente.');
            }
            
            // Funções auxiliares
            checkAuth() {
                return localStorage.getItem('zeroid_token') !== null;
            }
            
            getCurrentUser() {
                const user = localStorage.getItem('zeroid_user');
                return user ? JSON.parse(user) : null;
            }
            
            navigateTo(page) {
                window.location.href = page;
            }
        }
        
        // Inicializar chat quando a página carregar
        document.addEventListener('DOMContentLoaded', () => {
            window.chatManager = new ChatManager();
        });
        
        // Funções globais
        function navigateTo(page) {
            window.location.href = page;
        }
        
        window.navigateTo = navigateTo;
    </script>
</body>
</html>
